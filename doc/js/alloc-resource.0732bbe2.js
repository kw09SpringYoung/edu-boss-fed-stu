(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["alloc-resource"],{"04d1":function(e,t,r){var n=r("342f"),o=n.match(/firefox\/(\d+)/i);e.exports=!!o&&+o[1]},"0546":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"classifResources"},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("el-button",{attrs:{size:"small"},on:{click:e.onAdd}},[e._v("添加")])],1),r("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.resourceCategories}},[r("el-table-column",{attrs:{prop:"id",align:"center",label:"编号",width:"200"}}),r("el-table-column",{attrs:{align:"center",prop:"name",label:"名称","min-width":"180"}}),r("el-table-column",{attrs:{prop:"createdTime",align:"center",formatter:e.carTimeFilter,label:"创建时间","min-width":"180"}}),r("el-table-column",{attrs:{prop:"sort",label:"排序",align:"center","min-width":"180"}}),r("el-table-column",{attrs:{label:"操作",align:"center","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.onEdit(t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.onDelete(t.row)}}},[e._v("删除")])]}}])})],1)],1),r("el-dialog",{attrs:{title:e.isEdit?"编辑分类":"添加分类",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"resource-edit-add-tree",attrs:{"label-width":"80px",model:e.form}},[r("el-form-item",{attrs:{label:"名称"}},[r("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"排序"}},[r("el-input",{model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),r("el-form-item",[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onConfirm()}}},[e._v("确 定")])],1)],1)],1)],1)},o=[],s=r("1da1"),c=(r("b0c0"),r("4e82"),r("96cf"),r("2b0e")),a=r("9d1c"),i=c["default"].extend({name:"ResourceClassification",data:function(){return{resourceCategories:[],dialogVisible:!1,isEdit:!1,form:{name:"",sort:0}}},created:function(){this.loadResourceCategories()},methods:{loadResourceCategories:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(a["b"])();case 2:r=t.sent,n=r.data,e.resourceCategories=n.data;case 5:case"end":return t.stop()}}),t)})))()},carTimeFilter:function(e,t){var r=e[t.property];if(null!=r)return new Date(r).toLocaleDateString()},onAdd:function(){this.form.name="",this.form.sort=0,this.isEdit=!1,this.dialogVisible=!0},onConfirm:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=Object.assign({},e.row,e.form),e.row=null,t.next=4,Object(a["c"])(r);case 4:n=t.sent,o=n.data,e.$message.success(o.mesg),e.dialogVisible=!1,e.loadResourceCategories();case 9:case"end":return t.stop()}}),t)})))()},onEdit:function(e){this.row=e,this.form.name=e.name,this.form.sort=e.sort,this.isEdit=!0,this.dialogVisible=!0},onDelete:function(e){var t=this;this.$confirm("确认删除么？","删除提示",{}).then(Object(s["a"])(regeneratorRuntime.mark((function r(){var n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(a["a"])(e.id);case 2:n=r.sent,o=n.data,"000000"===o.code&&(t.loadResourceCategories(),t.$message.success("删除成功"));case 5:case"end":return r.stop()}}),r)})))).catch((function(){t.$message.info("已取消删除")}))}}}),u=i,l=r("2877"),d=Object(l["a"])(u,n,o,!1,null,"4e2eb2e9",null);t["default"]=d.exports},"4e82":function(e,t,r){"use strict";var n=r("23e7"),o=r("e330"),s=r("59ed"),c=r("7b0b"),a=r("07fa"),i=r("577e"),u=r("d039"),l=r("addb"),d=r("a640"),f=r("04d1"),h=r("d998"),m=r("2d00"),b=r("512ce"),g=[],v=o(g.sort),p=o(g.push),w=u((function(){g.sort(void 0)})),R=u((function(){g.sort(null)})),k=d("sort"),x=!u((function(){if(m)return m<70;if(!(f&&f>3)){if(h)return!0;if(b)return b<603;var e,t,r,n,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)g.push({k:t+n,v:r})}for(g.sort((function(e,t){return t.v-e.v})),n=0;n<g.length;n++)t=g[n].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}})),O=w||!R||!k||!x,C=function(e){return function(t,r){return void 0===r?-1:void 0===t?1:void 0!==e?+e(t,r)||0:i(t)>i(r)?1:-1}};n({target:"Array",proto:!0,forced:O},{sort:function(e){void 0!==e&&s(e);var t=c(this);if(x)return void 0===e?v(t):v(t,e);var r,n,o=[],i=a(t);for(n=0;n<i;n++)n in t&&p(o,t[n]);l(o,C(e)),r=o.length,n=0;while(n<r)t[n]=o[n++];while(n<i)delete t[n++];return t}})},"512ce":function(e,t,r){var n=r("342f"),o=n.match(/AppleWebKit\/(\d+)\./);e.exports=!!o&&+o[1]},"675f":function(e,t,r){"use strict";r.d(t,"d",(function(){return o})),r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return c})),r.d(t,"e",(function(){return a})),r.d(t,"f",(function(){return i})),r.d(t,"b",(function(){return u}));var n=r("b32d"),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["a"])({method:"POST",url:"/boss/resource/getResourcePages",data:e})},s=function(){return Object(n["a"])({method:"GET",url:"/boss/resource/category/getAll"})},c=function(e){return Object(n["a"])({method:"POST",url:"/boss/resource/allocateRoleResources",data:e})},a=function(e){return Object(n["a"])({method:"GET",url:"/boss/resource/getRoleResources",params:{roleId:e}})},i=function(e){return Object(n["a"])({method:"POST",url:"/boss/resource/saveOrUpdate",data:e})},u=function(e){return Object(n["a"])({method:"DELETE",url:"/boss/resource/".concat(e)})}},9614:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"allocResource",staticStyle:{"min-height":"50vh"}},[e._l(e.resources,(function(t){return r("el-card",{key:t.name,staticStyle:{"margin-bottom":"20px"},attrs:{shadow:"never"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("el-checkbox",{attrs:{indeterminate:t.isIndeterminate,checked:t.selected},on:{change:function(r){return e.handleCheckAllChange(t.selected,t)}},model:{value:t.selected,callback:function(r){e.$set(t,"selected",r)},expression:"resource.selected"}},[e._v(e._s(t.name))])],1),r("el-checkbox-group",{on:{change:function(r){return e.handleCheckedResourcesChange(t.checkedResources,t)}},model:{value:t.checkedResources,callback:function(r){e.$set(t,"checkedResources",r)},expression:"resource.checkedResources"}},e._l(t.subResourceList,(function(t){return r("el-checkbox",{key:t.id,staticStyle:{display:"inline-block",width:"230px","margin-top":"10px"},attrs:{label:t}},[e._v(e._s(t.name))])})),1)],1)})),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],staticStyle:{"text-align":"center"}},[r("el-button",{on:{click:e.resetChecked}},[e._v("清空")]),r("el-button",{attrs:{type:"primary"},on:{click:e.onSave}},[e._v("保存")])],1)],2)},o=[],s=r("2909"),c=r("1da1"),a=(r("96cf"),r("a9e3"),r("d3b7"),r("159b"),r("99af"),r("2b0e")),i=r("675f"),u=a["default"].extend({name:"AllocResource",props:{roleId:{type:[String,Number],require:!0}},data:function(){return{resources:[],resourceIdList:[],isLoading:!0}},created:function(){this.loadResources()},methods:{loadResources:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.next=3,e.loadAllResources();case 3:r=t.sent,e.isLoading=!1,e.resources=r;case 6:case"end":return t.stop()}}),t)})))()},getResources:function(e){var t=[];return function e(r){return r.forEach((function(r){r.resourceList||(t=[].concat(Object(s["a"])(t),[r])),r.resourceList&&e(r.resourceList)})),t}(e)},loadAllResources:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var r,n,o,s,c,a,u,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["e"])(e.roleId);case 2:return r=t.sent,n=r.data,o=e.getResources(n.data),t.next=7,Object(i["c"])();case 7:for(s=t.sent,c=s.data,c=c.data,a=0;a<c.length;a++){for(c[a].checkedResources=[],c[a].subResourceList=[],c[a].isIndeterminate=!1,u=0;u<o.length;u++)c[a].id===o[u].categoryId&&(c[a].subResourceList.push(o[u]),o[u].selected&&c[a].checkedResources.push(o[u]));l=c[a].checkedResources.length,d=c[a].subResourceList.length,c[a].selected=l===d&&0!==l&&0!==d}return t.abrupt("return",c);case 12:case"end":return t.stop()}}),t)})))()},handleCheckAllChange:function(e,t){t.checkedResources=e?t.subResourceList:[],t.isIndeterminate=!1},handleCheckedResourcesChange:function(e,t){var r=e.length;t.selected=r===t.subResourceList.length,t.isIndeterminate=r>0&&r<t.subResourceList.length},onSave:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=[],e.resourceIdList=[],e.resources.forEach((function(e){r=r.concat(e.checkedResources)})),r.forEach((function(t){e.resourceIdList=e.resourceIdList.concat(t.id)})),console.log(e.resourceIdList),t.next=7,Object(i["a"])({roleId:e.roleId,resourceIdList:e.resourceIdList});case 7:e.$message.success("操作成功"),e.$router.push({name:"role"});case 9:case"end":return t.stop()}}),t)})))()},resetChecked:function(){this.resources.forEach((function(e){e.selected=!1,e.checkedResources=[]}))}}}),l=u,d=r("2877"),f=Object(d["a"])(l,n,o,!1,null,"2eb4e2c6",null);t["default"]=f.exports},"9d1c":function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return c}));var n=r("b32d"),o=function(){return Object(n["a"])({method:"GET",url:"/boss/resource/category/getAll"})},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["a"])({method:"POST",url:"/boss/resource/category/saveOrderUpdate",data:e})},c=function(e){return Object(n["a"])({method:"DELETE",url:"/boss/resource/category/".concat(e)})}},addb:function(e,t,r){var n=r("4dae"),o=Math.floor,s=function(e,t){var r=e.length,i=o(r/2);return r<8?c(e,t):a(e,s(n(e,0,i),t),s(n(e,i),t),t)},c=function(e,t){var r,n,o=e.length,s=1;while(s<o){n=s,r=e[s];while(n&&t(e[n-1],r)>0)e[n]=e[--n];n!==s++&&(e[n]=r)}return e},a=function(e,t,r,n){var o=t.length,s=r.length,c=0,a=0;while(c<o||a<s)e[c+a]=c<o&&a<s?n(t[c],r[a])<=0?t[c++]:r[a++]:c<o?t[c++]:r[a++];return e};e.exports=s},d998:function(e,t,r){var n=r("342f");e.exports=/MSIE|Trident/.test(n)}}]);
//# sourceMappingURL=alloc-resource.0732bbe2.js.map